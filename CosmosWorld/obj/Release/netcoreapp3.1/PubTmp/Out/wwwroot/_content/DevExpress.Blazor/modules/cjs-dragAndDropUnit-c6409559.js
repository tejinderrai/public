DxBlazorInternal.define("cjs-dragAndDropUnit-c6409559.js",(function(t,e,i){t("./cjs-chunk-c5286524.js");var n=t("./cjs-dom-utils-c4472fdd.js"),o=t("./cjs-chunk-2cdecb19.js"),s=t("./cjs-chunk-dcd3551a.js"),r=function(t,e,i,o,s,r){this.isModal=r,this.itemForDrag=t,n.ensureElement(this.itemForDrag),this.container=e,this.getDropTarget=i,this.clean=!1,this.getZeroPoint=s,o&&(this.dragAnchor=this.itemForDrag.querySelector(o)),this.dragAnchor||(this.dragAnchor=this.itemForDrag),this.cloneForMove=null,this.reset()},h={contentHeight:{configurable:!0},cursor:{configurable:!0},isScrollActive:{configurable:!0},scrollContainer:{configurable:!0},scrollingCorrection:{configurable:!0}};r.prototype.dropEvents=function(){this.events&&(this.events.dispose(),this.events=null)},r.prototype.dropTempObject=function(){this.currentPoint=null,this.startPoint=null,this.cloneForMove&&(this.cloneForMove.parentNode.removeChild(this.cloneForMove),this.cloneForMove=null)},r.prototype.reset=function(){if(!this.clean){this.clean=!0,this.dropTempObject(),this.dropEvents(),this.events||(this.events=new s.EventRegister(this));var t=this;this.eventTokenDragStart=this.events.attachEvent(this.dragAnchor,o.TouchUIHelper.touchMouseDownEventName,(function(t){this.dragTriger(t)})),this.container.size=function(){return m(t.container).size},this.itemForDrag.size=function(){return m(t.itemForDrag).size},this.itemForDrag.location=function(){return m(t.itemForDrag).location},this.contentHeightInt=-1}},r.prototype.stop=function(){this.clean=!1,this.dropEvents()},r.prototype.dispose=function(){this.dropTempObject(),this.dropEvents(),this.onDragStart=null,this.onDrag=null,this.onDrop=null,this.onDragEndAnimateEnd=null,this.onDragCancel=null,this.itemForDrag=null,this.container=null},h.contentHeight.get=function(){if(-1===this.contentHeightInt){this.contentHeightInt=0;for(var t=this.scrollContainer.children,e=0;e<t.length;e++)t[e]!==this.cloneForMove&&(this.contentHeightInt+=t[e].getBoundingClientRect().height)}return this.contentHeightInt},h.cursor.get=function(){return this.cursorPoint},h.isScrollActive.get=function(){return this.contentHeight!==m(this.scrollContainer).height},h.scrollContainer.get=function(){if(this.isModal){if(!this._scrollContainer)for(var t=this.container;t!==window&&t.classList;){if(t.classList.contains("modal-body")){this._scrollContainer=t;break}t=t.parentNode}return this._scrollContainer}return this.container},h.scrollingCorrection.get=function(){return this.isModal&&this.isScrollActive?{y:this.scrollingStart-this.scrollContainer.scrollTop}:{y:0}},r.prototype.dragTriger=function(t){this.updateCursor(t);var e=this.cursor.clone(),i=null,n=null,s=function(){i.dispose(),n.dispose()};return i=this.events.attachEvent(document,o.TouchUIHelper.touchMouseMoveEventName,(function(i){return this.updateCursor(i),g(e,"-",this.cursor).scalarLength>3&&(s(),this.clean=!1,this.dragStart(t)),i.preventDefault(),!1})),n=this.events.attachEvent(document,o.TouchUIHelper.touchMouseUpEventName,s),t.preventDefault(),!1},r.prototype.dragStart=function(t){var e,i;this.itemForDrag&&(this.updateCursor(t),this.eventTokenDragStart.dispose(),this.cloneForMove=((i=(e=this.itemForDrag).cloneNode(!0)).center=function(){return m(i).center},i.size=function(){return m(i).size},i.style.transition="none",i.style.width=e.offsetWidth+"px",i.style.height=e.offsetHeight+"px",i.style.visibility="hidden",i.classList.add("in-drag"),n.eraseBlazorIdentificators(i),i),this.itemForDrag.parentNode.insertBefore(this.cloneForMove,this.itemForDrag),this.onDragStart&&this.onDragStart(this.itemForDrag),this.scrollingStart=this.scrollContainer.scrollTop,this.eventTokenDrag=this.events.attachEvent(document,o.TouchUIHelper.touchMouseMoveEventName,(function(t){this.drag(t)})),this.eventTokenDragEnd=this.events.attachEvent(document,o.TouchUIHelper.touchMouseUpEventName,(function(t){this.dragEnd(t)})))},r.prototype.drag=function(t){if(this.itemForDrag&&this.cloneForMove){this.updateCursor(t),this.scroll(),this.startPoint||(this.currentPoint=this.cursor.clone(),this.cloneForMove.style.visibility="visible",this.startPoint=m(this.cloneForMove).location);var e=g(this.scrollContainer,"-",this.cloneForMove.size());e.width=0,this.currentPoint=this.cursor.limitByRectangle(e);var i=g(this.currentPoint,"-",this.startPoint,"-",this.scrollingCorrection);this.translateElement(this.cloneForMove,i,0),this.onDrag&&(t.centerOfDraggingObject=this.toRelativeCoord(this.cloneForMove.center()),this.onDrag(this.itemForDrag,t))}},r.prototype.dragEnd=function(t){if(this.itemForDrag&&this.cloneForMove&&this.startPoint){this.eventTokenDrag.dispose(),this.eventTokenDragEnd.dispose();var e=this.getDropTarget(this.toRelativeCoord(this.cloneForMove.center()));if(e&&this.itemForDrag!==e.item){this.onDrop&&this.onDrop(this.itemForDrag,e.item);var i=g(this.toScreanCoord(e.relativeRect),"-",this.startPoint,"-",this.scrollingCorrection);return this.animateItem(this.cloneForMove,i,(function(){this.cloneForMove&&(this.cloneForMove.style["box-shadow"]="none"),this.onDropAnimationEnd&&this.onDropAnimationEnd(this.itemForDrag,e.item)})),void 0}this.cloneForMove&&this.animateItem(this.cloneForMove,{x:0,y:0},(function(){this.onDragCancel(this.itemForDrag),this.reset()}))}},r.prototype.scroll=function(){if(this.isScrollActive){var t=this.scrollContainer.getBoundingClientRect(),e=this.cursor.y+this.cloneForMove.size().height+2-t.bottom;if(e>0)return this.scrollContainer.scrollTop=Math.min(this.scrollContainer.scrollTop+e,this.contentHeight-t.height),void 0;(e=this.cursor.y-2-t.top)<0&&(this.scrollContainer.scrollTop=Math.max(this.scrollContainer.scrollTop+e,0))}},r.prototype.updateCursor=function(t){this.cursorPoint=new l(this.getClientEventPos(t,"clientX"),this.getClientEventPos(t,"clientY")-this.itemForDrag.size().height/2)},r.prototype.translateElement=function(t,e,i){var n=t.style.transform;if(0===e.x&&0===e.y&&(n.includes("translate(0px)")||n.includes("translate(0px,0px)")))return!1;t.style.transition="all "+i+"s";var o=["translate(",Math.round(e.x),"px, ",Math.round(e.y),"px)"].join("");return!n.includes(o)&&(t.style.transform=o,!0)},r.prototype.animateItem=function(t,e,i){var n=null,o=function(){n.dispose(),i.call(this)};n=this.events.attachEvent(t,"transitionend",o);var s=this.translateElement(t,e,"0.2");return s||o.call(this),s},r.prototype.toRelativeCoord=function(t){return g(t,"-",this.getZeroPoint())},r.prototype.toScreanCoord=function(t){return g(t,"+",this.getZeroPoint())},r.prototype.getClientEventPos=function(t,e){return void 0!==t[e]?t[e]:void 0!==t.touches&&t.touches[0]&&t.touches[0][e]?t.touches[0][e]:void 0!==t.changedTouches&&t.changedTouches[0]&&t.changedTouches[0][e]?t.changedTouches[0][e]:0},Object.defineProperties(r.prototype,h);var c=function(t,e,i,n){this.inputSelector=e,this.focusElement=t,this.container=i,this.input=e?this.focusElement.querySelector(e):null,this.restrictClick=!1,this.isBlurMode=n,this.lock=!1,this.reset()};c.prototype.onKeydown=function(t){32!==t.keyCode&&13!==t.keyCode||this.restrictClick||t.target!==this.focusElement||t.currentTarget!==this.focusElement||(this.lock=!0,this.input.click(),this.focusElement.setAttribute("aria-selected",this.input.checked),this.lock=!1)},c.prototype.onClickInternal=function(t){this.onClick&&!this.lock&&this.onClick(this.focusElement)},c.prototype.onFocusInternal=function(){this.updateStyleMetadata(),this.onFocus&&this.onFocus(this.focusElement)},c.prototype.onBlurInternal=function(){this.onBlur&&this.onBlur(this.focusElement)},c.prototype.reset=function(){var t;this.events&&this.events.dispose(),this.events=new s.EventRegister(this),this.input&&(this.input.tabIndex=-1,this.events.attachEvent(this.input,"focus",(function(){this.input.blur()})),this.events.attachEvent(this.input,"click",(function(){this.onClickInternal()})),this.events.attachEvent(this.focusElement,"keydown",this.onKeydown)),this.resetStyleMetadata(),document.activeElement===this.focusElement&&(this.updateStyleMetadata(),this.isBlurMode&&this.focusElement.blur()),this.isBlurMode?t=function(){this.focusElement.blur()}:(t=this.OnFocusInternal,this.events.attachEvent(this.focusElement,"blur",this.onBlurInternal)),this.events.attachEvent(this.focusElement,"focus",t),this.events.attachEvent(this.focusElement,"mousedown",(function(t){t.preventDefault()})),this.restrictClick=!1},c.prototype.stop=function(){this.restrictClick=!0},c.prototype.focus=function(){this.isBlurMode||this.focusElement.focus()},c.prototype.blur=function(){this.focusElement.blur()},c.prototype.dispose=function(){this.events&&this.events.dispose(),this.events=null,this.focusElement=null,this.input=null},c.prototype.resetStyleMetadata=function(){void 0!==this.focusElement.style&&this.focusElement.style&&(this.focusElement.style.removeProperty("--h"),this.focusElement.style.removeProperty("--t"),this.focusElement.style.removeProperty("--bt"))},c.prototype.updateStyleMetadata=function(){if(void 0===this.focusElement.style||!this.focusElement.style||!this.focusElement.style.cssText){var t=m(this.focusElement),e=m(this.container),i=window.getComputedStyle(this.focusElement)["border-top-width"];this.focusElement.setAttribute("style","--h:"+t.height+"px; --t:"+(t.y-e.y)+"px; --bt:"+i+";")}};var l=function(t,e){this.x=t,this.y=e},a={length:{configurable:!0}};l.prototype.clone=function(){return new l(this.x,this.y)},a.length.get=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},l.prototype.equal=function(t){return this.x===t.x&&this.y===t.y},l.prototype.limitByRectangle=function(t){var e=Math.min(Math.max(this.y,t.top),t.bottom),i=Math.min(Math.max(this.x,t.left),t.right);return new l(i,e)},l.prototype.isInRect=function(t){return t.left<=this.x&&this.x<=t.right&&t.top<=this.y&&this.y<=t.bottom},Object.defineProperties(l.prototype,a);var u=function(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n},p={left:{configurable:!0},top:{configurable:!0},bottom:{configurable:!0},right:{configurable:!0},size:{configurable:!0},location:{configurable:!0},center:{configurable:!0},scalarLength:{configurable:!0}};function g(){var t=Array.from(arguments),e=[],i=[];t.forEach((function(t){"-"===t||"+"===t?e.push(t):i.push(t)}));for(var n=[];i.length>0;)n.push(i.pop());for(;e.length>0;)n.push(e.shift());for(;n.length>0;){var o=n.shift();e.push("+"===o?f(e.pop(),e.pop()):"-"===o?d(e.pop(),e.pop()):o)}return e.pop()}function f(t,e){var i=v(t),n=v(e);return new u(i.x+n.x,i.y+n.y,i.width+n.width,i.height+n.height)}function d(t,e){var i=v(t),n=v(e);return new u(i.x-n.x,i.y-n.y,i.width-n.width,i.height-n.height)}function v(t){if(t.getBoundingClientRect)return m(t);var e=0,i=0,n=0,o=0;return t.x&&(e=t.x),t.y&&(i=t.y),t.width&&(n=t.width),t.height&&(o=t.height),{x:e,y:i,width:n,height:o}}function m(t){var e=t.getBoundingClientRect();return e&&e.left&&e.top&&!e.x&&!e.y&&(e.x=Math.min(e.left,e.right),e.y=Math.min(e.top,e.bottom)),new u(e.x,e.y,e.width,e.height)}function y(t){var e=m(t),i=window.getComputedStyle(t),n=E(i.marginLeft),o=E(i.marginRight),s=E(i.marginTop),r=E(i.marginBottom);return new u(e.x-n,e.y-s,e.width+n+o,e.height+s+r)}function E(t){return Math.max(parseFloat(t),0)}u.prototype.clone=function(){return new u(this.x,this.y,this.width,this.height)},p.left.get=function(){return this.x},p.top.get=function(){return this.y},p.bottom.get=function(){return this.y+this.height},p.right.get=function(){return this.x+this.width},p.size.get=function(){return new u(0,0,this.width,this.height)},p.location.get=function(){return new u(this.x,this.y,0,0)},p.center.get=function(){return new u(this.x+this.width/2,this.y+this.height/2,0,0)},p.scalarLength.get=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},u.prototype.equal=function(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},u.prototype.limitByRectangle=function(t){var e=Math.min(Math.max(this.y,t.top),t.bottom),i=Math.min(Math.max(this.x,t.left),t.right);return new u(i,e,0,0)},Object.defineProperties(u.prototype,p);var M={DragAndDropUnit:r,FocusUnit:c,RectBlz:u,PointBlz:l,getClientRect:m,getClientRectWithMargins:y,geometry:g};i.DragAndDropUnit=r,i.FocusUnit=c,i.PointBlz=l,i.RectBlz=u,i.default=M,i.geometry=g,i.getClientRect=m,i.getClientRectWithMargins=y}),["cjs-chunk-c5286524.js","cjs-dom-utils-c4472fdd.js","cjs-chunk-2cdecb19.js","cjs-chunk-dcd3551a.js"]);
