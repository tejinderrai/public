DxBlazorInternal.define("cjs-columnchooser-f3c1c673.js",(function(n,e,t){n("./cjs-chunk-c5286524.js");var o=n("./cjs-dom-utils-c4472fdd.js");n("./cjs-chunk-2cdecb19.js");var c,s,i,a,r,u,l,d,f,p,m=n("./cjs-chunk-dcd3551a.js"),v=n("./cjs-dragAndDropUnit-c6409559.js"),h=null,g=-1,w=-1,j=!0,y=!1;function E(n,e,t,c){if(n.forEach((function(n){o.ensureElement(n)})),a?a._id!==c._id&&(I(a),a=c):a=c,!d)for(var l=d=e;l.parentNode!==document&&l.classList;){if(l.classList.contains("modal-body")){y=!0;break}l=l.parentNode}if(r=new Map,u&&u.dispose(),u=new m.EventRegister(d),h||(s=new Map,i=new Map,h=n),w=-1,u.attachEventWithContext(document,"keydown",L,document),h&&(h.sort((function(n,e){return n.dataset.vindex-e.dataset.vindex})),f=function(n,e){if(y)return n;var t=n,o=window.getComputedStyle(t);for(;o.position!==e&&t.parentNode!==document;)t=t.parentNode,o=window.getComputedStyle(t);return t}(d,"absolute"),x(t&&!y),k()))var v=u.attachEvent(f,"focusin",(function(){v.dispose(),h[0].focus()}));M(),p&&(p.parentNode.removeChild(p),p=null)}function x(n){j=n,l&&l.dispose();var e=document.querySelector(".column-chooser-exit-button");l=e?new v.FocusUnit(e,null,d,!j):null,i.forEach((function(n){n.dispose()})),i=new Map,h.forEach((function(n){!function(n,e){var t=s.get(n.dataset.column);t||((t=new v.DragAndDropUnit(n,n.parentNode,z,".column-chooser-drag-icon-owner",B,y)).onDragStart=A,t.onDrag=F,t.onDragCancel=U,t.onDropAnimationEnd=S,s.set(n.dataset.column,t));t.reset(),n.classList.remove("up"),n.classList.remove("down"),n.classList.remove("freeze");var o=i.get(n.dataset.column);o||((o=new v.FocusUnit(n,".custom-control-input",e,y||!j)).onFocus=D,o.onBlur=C,o.onClick=N,i.set(n.dataset.column,o));o.reset()}(n,f)}))}function k(){return j}function L(n){switch(k()||(x(!0),9===n.keyCode&&h[h.length-1].focus()),n.keyCode){case 32:w>=0&&(n.preventDefault(),h[w].click());break;case 38:n.preventDefault(),b(-1);break;case 40:n.preventDefault(),b(1)}}function b(n){if(h&&s){w=(w+=n)<0?h.length-1:w;var e=i.get(h[w%=h.length].dataset.column);e&&e.focus()}}function D(n){w=h.indexOf(n)}function C(n){w===h.indexOf(n)&&(w===h.length-1&&l&&l.focus(),w=-1)}function N(n){k()&&x(!1)}function O(n){return h.find((function(e,t,o){return function(n,e){var t=R(n);if(!t)return!1;return t.top<=e&&e<=t.bottom}(e,n.y)}))}function z(n){var e=O(n);return e?{item:e,relativeRect:R(e)}:null}function M(){if(c&&c.style){var n=s.get(c.dataset.column);n&&n.reset();var e=i.get(c.dataset.column);e&&e.reset(),g=-1,c.childNodes.forEach((function(n){n.style&&(n.style.visibility="")})),c=null}}function A(n){g=h.indexOf(c=n),h.forEach((function(n){n.blur(),n!==c&&n.classList.add("freeze")})),c.childNodes.forEach((function(n){n.style&&(n.style.visibility="hidden")}));var e=i.get(c.dataset.column);e&&e.stop()}function R(n){var e=r.get(n);if(e)return e;var t=v.getClientRect(n),o=B();return e=new v.RectBlz(t.x-o.x,t.y-o.y,t.width,t.height),r.set(n,e),e}function S(n,e){h.forEach((function(n){s.get(n.dataset.column).stop()})),p=d.cloneNode(!0),o.eraseBlazorIdentificators(p),p.style["z-index"]=2e3,d.parentNode.appendChild(p),a.invokeMethodAsync("OnElementsExchange",n.dataset.column,e.dataset.column).catch((function(n){window.console.error(n)}))}function U(n){h.forEach((function(n){n.classList.remove("up"),n.classList.remove("down"),n.classList.remove("freeze")})),M()}function B(){var n=y?d.parentNode:d,e=v.getClientRect(n);return 0!==n.scrollTop?{x:e.x,y:e.y-n.scrollTop}:e.location}function _(n){i.get(n.dataset.column).updateStyleMetadata()}function F(n,e){if(n){-1===g&&(g=h.indexOf(n));var t=O(e.centerOfDraggingObject);if(t){var o=h.indexOf(t),s=!1;h.forEach(g<o?function(n){c===n&&(s=!0),s?(_(n),n.classList.add("up")):n.classList.remove("up","down"),t===n&&(s=!1)}:g>o?function(n){t===n&&(s=!0),s?(_(n),n.classList.add("down")):n.classList.remove("up","down"),c===n&&(s=!1)}:function(n){n.classList.remove("up","down")})}}}function I(n){n._id===a._id&&(s.forEach((function(n){n.dispose()})),i.forEach((function(n){n.dispose()})),h=null,c=null,g=-1,d=null,r=null,s=null,i=null,a=null,u&&u.dispose(),u=null,p&&(p.parentNode.removeChild(p),p=null))}t.default={init:E,dispose:I},t.dispose=I,t.init=E}),["cjs-chunk-c5286524.js","cjs-dom-utils-c4472fdd.js","cjs-chunk-2cdecb19.js","cjs-chunk-dcd3551a.js","cjs-dragAndDropUnit-c6409559.js"]);
