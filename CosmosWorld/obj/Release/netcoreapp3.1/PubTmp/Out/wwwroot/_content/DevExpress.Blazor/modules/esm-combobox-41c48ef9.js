import"./esm-chunk-d81494b9.js";import{ensureElement as e,attachEventToElement as t,elementIsInDOM as o,detachEventFromElement as n}from"./esm-dom-utils-88a2c0cb.js";import{d as s,r}from"./esm-chunk-fc46b9cc.js";import{T as c}from"./esm-chunk-639f7231.js";import{K as u}from"./esm-chunk-54fd5426.js";import{getDropDownElement as i,onOutsideClick as a,isDropDownVisible as d}from"./esm-dropdowns-b1b0a8a9.js";import"./esm-chunk-13e2cf5f.js";import{scrollToFocusedItem as m,getParametersForVirtualScrollingRequest as l}from"./esm-grid-627c475b.js";import"./esm-popup-utils-20f67cc2.js";import"./esm-focus-utils-eb2e3d52.js";import"./esm-chunk-5d9ef2cd.js";import"./esm-dragAndDropUnit-ce1d0bbc.js";import{k as f,a as p}from"./esm-chunk-0a0b72b5.js";function k(e){const t=i(e);m(t)}function y(t){t=e(t),document.activeElement===t&&b(t)}function C(e,t){e.dataset.timerId&&(clearTimeout(e.dataset.timerId),delete e.dataset.timerId),t||setTimeout((function(){C(e,!0)}),100)}function b(e){e&&e.dataset.focusedClass&&(e.className=e.dataset.focusedClass)}function g(e,t){return t&&f(e),function(e){return v(e)||e.keyCode===u.Enter}(e)&&(e.stopPropagation(),e.preventDefault()),!1}function h(e,t,o,n,s){let r=!1;if(n&&(r=r||p(e)),r=r||function(e){const t=e.altKey&&(e.keyCode===u.Down||e.keyCode===u.Up),o=v(e),n=e.keyCode===u.Esc||e.keyCode===u.Enter;return t||o||n}(e),r){const n=e.target.value;if(o&&s){const s=o.querySelector(".dxgvCSD");s&&(o=s);const r=l(o,!1);t.invokeMethodAsync("OnComboBoxListBoxKeyUp",n,e.keyCode,e.altKey,e.ctrlKey,r.requestScrollState.itemHeight,r.requestScrollState.scrollTop,r.requestScrollState.scrollHeight)}else t.invokeMethodAsync("OnComboBoxKeyUp",n,e.keyCode,e.altKey,e.ctrlKey)}}function v(e){return e.keyCode===u.Down||e.keyCode===u.Up||e.keyCode===u.PageUp||e.keyCode===u.PageDown||e.ctrlKey&&(e.keyCode===u.Home||e.keyCode===u.End)}function j(e,t,o){if(!t)return;const n=(new Date).getTime();t.dataset.lastLostFocusTime&&n-t.dataset.lastLostFocusTime<300&&!o||(t.dataset.lastLostFocusTime=(new Date).getTime(),e.invokeMethodAsync("OnComboBoxLostFocus",t.value))}function w(u,m,l){const f=e(u);if(!f)return;s(f);const p=m.filteringEnabled,k=e(m.inputElement),y=i(f),v=y,w=function(e){return g(e,p)},E=function(e){return h(e,l,v,p,m.virtualScrollingEnabled)},T=function(e){return function(e,t){b(e.target)}(e)},D=function(e){return function(e,t){const o=e.target;C(o,!0),o.dataset.timerId=setTimeout((function(){if(delete o.dataset.timerId,function(e){e&&e.dataset.bluredClass&&(e.className=e.dataset.bluredClass)}(o),document.activeElement!==o)try{j(t,o)}catch(e){}}),200)}(e,l)},S=function(e){return C(k)},I=function(e){return a(e,f,(function(){o(f)||s(f);const e=document.activeElement===k,t=k.dataset.timerId>0,n=y&&d(y);C(k),(e||t||n)&&j(l,k,!0)}))};return t(k,"keydown",w),t(k,"keyup",E),t(k,"focus",T),t(k,"blur",D),t(f,"mousedown",S),t(document,c.touchMouseDownEventName,I),r(f,(function(){n(k,"keydown",w),n(k,"keyup",E),n(k,"focus",T),n(k,"blur",D),n(f,"mousedown",S),n(document,c.touchMouseDownEventName,I)})),Promise.resolve("ok")}function E(t){if(t=e(t))return s(t),Promise.resolve("ok")}const T={init:w,dispose:E,prepareInputIfFocused:y,scrollToSelectedItem:k};export default T;export{E as dispose,w as init,y as prepareInputIfFocused,k as scrollToSelectedItem};
